<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SDG 13 ‚Äì Climate Action AI</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:'Inter',sans-serif;margin:0;padding:0;}
body{min-height:100vh;background:linear-gradient(135deg,#d4fc79,#96e6a1);display:flex;justify-content:center;align-items:center;}

/* ===== MAIN CARD ===== */
.container{
  width:400px;
  max-height:90vh;
  background:#fff;
  border-radius:18px;
  box-shadow:0 12px 35px rgba(0,0,0,0.2);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

/* ===== HEADER ===== */
.header{
  padding:20px;
  text-align:center;
  background:linear-gradient(135deg,#2e7d32,#1b5e20);
  color:#fff;
}
.header h1{margin-bottom:5px;font-size:20px;}
.header p{font-size:13px;opacity:0.9;}

/* ===== TABS ===== */
.tabs{display:flex;border-bottom:1px solid #ddd;}
.tab{
  flex:1;text-align:center;padding:10px;cursor:pointer;font-weight:bold;background:#f1f8e9;
  transition:background 0.2s;
}
.tab.active{background:#e8f5e9;}

/* ===== TAB CONTENT ===== */
.tab-content{display:none;padding:15px;overflow-y:auto;max-height:calc(90vh - 140px);}
.tab-content.active{display:block;}

/* ===== CARBON CALCULATOR ===== */
label{font-size:13px;font-weight:600;color:#333;}
input[type="number"]{width:100%;margin:6px 0 16px;padding:10px 12px;border-radius:8px;border:1px solid #ccc;font-size:14px;}
input:focus{outline:none;border-color:#2e7d32;box-shadow:0 0 0 2px rgba(46,125,50,0.15);}
button{width:100%;padding:12px;background:linear-gradient(135deg,#2e7d32,#1b5e20);color:#fff;border:none;border-radius:10px;font-size:15px;font-weight:bold;cursor:pointer;transition:transform 0.2s, box-shadow 0.2s;}
button:hover{transform:translateY(-2px);box-shadow:0 6px 15px rgba(0,0,0,0.2);}
.result{margin-top:20px;padding:14px;border-radius:10px;background:#f1f8e9;color:#1b5e20;font-weight:bold;text-align:center;display:none;}

/* ===== CHATBOT ===== */
.chat-box{height:300px;overflow-y:auto;padding:10px;background:#f1f8e9;border-radius:10px;display:flex;flex-direction:column;gap:8px;}
.msg{max-width:80%;padding:10px 14px;border-radius:14px;font-size:14px;line-height:1.4;}
.user{background:#c8e6c9;align-self:flex-end;border-bottom-right-radius:4px;}
.bot{background:#fff;align-self:flex-start;border-bottom-left-radius:4px;}
.error{background:#ffe6e6;border-left:3px solid #d32f2f;color:#b71c1c;align-self:flex-start;}

/* ===== CHAT INPUT ===== */
.chat-input{display:flex;margin-top:10px;gap:8px;}
.chat-input input{flex:1;padding:12px;border-radius:12px;border:1px solid #ccc;font-size:15px;}
.chat-input input:focus{border-color:#2e7d32;outline:none;}
.chat-input button{padding:0 14px;border:none;border-radius:50%;background:#2e7d32;color:#fff;font-size:18px;cursor:pointer;transition:0.2s;}
.chat-input button:hover{transform:scale(1.1);}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <h1>üåç SDG 13 ‚Äì Climate Action</h1>
    <p>Ask questions or calculate your carbon footprint</p>
  </div>

  <div class="tabs">
    <div class="tab active" data-tab="calculator">üå± Carbon Calculator</div>
    <div class="tab" data-tab="chatbot">üí¨ AI Chatbot</div>
  </div>

  <!-- CARBON CALCULATOR -->
  <div id="calculator" class="tab-content active">
    <label>Daily Transport Distance (km)</label>
    <input type="number" id="transport" placeholder="e.g. 20">

    <label>Monthly Electricity Usage (units)</label>
    <input type="number" id="electricity" placeholder="e.g. 150">

    <label>Meat-based Meals per Week</label>
    <input type="number" id="meat" placeholder="e.g. 4">

    <button onclick="checkImpact()">Check Impact</button>

    <div class="result" id="calcResult"></div>
  </div>

  <!-- AI CHATBOT -->
  <div id="chatbot" class="tab-content">
    <div class="chat-box" id="chat"></div>
    <div class="chat-input">
      <input id="input" placeholder="Ask me anything about climate action..." />
      <button onclick="send()">‚û§</button>
    </div>
  </div>

</div>

<script>
/* TAB SWITCH */
const tabs = document.querySelectorAll(".tab");
const contents = document.querySelectorAll(".tab-content");
tabs.forEach(tab=>{
  tab.addEventListener("click",()=>{
    tabs.forEach(t=>t.classList.remove("active"));
    contents.forEach(c=>c.classList.remove("active"));
    tab.classList.add("active");
    document.getElementById(tab.dataset.tab).classList.add("active");
  });
});

/* CARBON CALCULATOR */
function checkImpact(){
  const t = Number(document.getElementById("transport").value);
  const e = Number(document.getElementById("electricity").value);
  const m = Number(document.getElementById("meat").value);
  const total = t + e/30 + m*0.5;
  let level="",color="";
  if(total<10){level="Low üå±";color="#c8e6c9";}
  else if(total<20){level="Moderate ‚ö°";color="#fff3cd";}
  else{level="High üî•";color="#fdecea";}

  const result = document.getElementById("calcResult");
  result.style.display="block";
  result.style.background=color;
  result.style.color=(total<20?"#1b5e20":"#b71c1c");
  result.innerText=`Carbon Score: ${total.toFixed(1)}\nImpact Level: ${level}`;
}

/* CHATBOT */
const chat = document.getElementById("chat");
const input = document.getElementById("input");

function addMessage(text,sender){
  const div = document.createElement("div");
  div.className = `msg ${sender}`;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

// Initial bot message
addMessage("Hello üå± I am your Climate AI. Ask me anything!", "bot");

async function send(){
  const text = input.value.trim();
  if(!text) return;
  addMessage(text,"user");
  input.value = "";

  const thinking = document.createElement("div");
  thinking.className="msg bot";
  thinking.textContent="Thinking... ü§ñ";
  chat.appendChild(thinking);
  chat.scrollTop = chat.scrollHeight;

  try{
    const res = await fetch("https://my-sdg13-backend.onrender.com/chat",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:text})
    });
    const data = await res.json();
    chat.removeChild(thinking);
    addMessage(data.reply || "No response from AI.","bot");
  }catch(err){
    chat.removeChild(thinking);
    addMessage("‚ùå Unable to connect to AI server","error");
    console.error(err);
  }
}

input.addEventListener("keypress",function(e){
  if(e.key==="Enter") send();
});
</script>

</body>
</html>
